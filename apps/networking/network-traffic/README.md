# Network Traffic Problem
# Table of Contents
- [Problem Statement](#problem-statement)
- [Solution approach](#solution-approach)

# Problem statement

Given a Statistic information dataset of a Network traffic flow generated by  CICFlowMeter, indicate wheather the traffic is malicious attack(Bot) or not eg : Bengin.

## Dataset details

The dataset is available at - 

https://cse-cic-ids2018.s3.ca-central-1.amazonaws.com/Processed+Traffic+Data+for+ML+Algorithms/Friday-02-03-2018_TrafficForML_CICFlowMeter.csv

Features extracted from the captured traffic using CICFlowMeter-V3 = 80  
Labels to be identified : Bot or Bengin

# Solution approach

After Removal of Noise, Number of Feature columns:  10.  
Number of data points: 10000

## Tensorflow details

The model is developed using Tensorflow's DNNClassifier. This classifier builds a feedforward multilayer neural network that is trained on a set of labeled data in order to perform classification on similar, unlabeled data.

## Building, training and evaluating the neural network

The DNNClassifier requires feature columns (input layer), the architecture of the neural network (hidden layers) and the number of classes (output layer) to be specified. Consequently, input columns in the dataset are mapped directly to feature columns(input layer); _3_ hidden layers each with _13_, _65_ and _110_ neurons/nodes respectively were used; and, the output layer has _2_ classes, which classifies the location.




## Network Model Training and Serving through kustomize
 
### Pre-req

Kustomize
Kubectl
GKE = 1.13
 
### Deploy Network training

Run the command to start Network training through  kustomize
 
     $ kustomize build blerssi_kustomize/base/network_train | kubectl apply -f -
     
     tfjob.kubeflow.org/train-network-tfjob created
   
Ensure training pods are running
  
     $ kubectl get pods -n kubeflow

     train-network-tfjob-master-0                                  0/1     Running   0          58s
     train-network-tfjob-ps-0                                      1/1     Running   0          59s
     train-network-tfjob-worker-0                                  1/1     Running   0          58s
 
 After training is completed, the model will be stored in PVC through nfs.
 
 ### Deploy Network Serving
 
Run the command to Serve Network model through kustomize using TF-Serving
 
     $ kustomize build blerssi_kustomize/base/network_serve | kubectl apply -f -
 
      service/serve-network-service created
      deployment.apps/serve-network-v1 create

  Ensure serve blerssi pod is running.
  
     $ kubectl get pods -n kubeflow

     serve-network-v1-5d46dbb756-g2gfm                             1/1     Running       0          15s
   
 
### Model Testing

The model can be tested using a local python client

#### Using a local python client

Make necessary changes in network_client.py file and provide Network Serving IP

     $ python3 network_client.py
   
     Result:
    
	The output will be displayed with the predicted Labels in the CLI
    FlowDuration  BwdIATTot  BwdPktLenMax    FlowIATStd  BwdPktLenMean  FwdPSHFlags   FlowIATMean  BwdIATMean  FwdSegSizeMin  InitBwdWinByts Location  Probability
    1.180843e-03   0.000428      1.000000  5.167782e-04       0.413634          0.0  7.919888e-05    0.000134            1.0        0.002491      Bot     0.534985
    2.338568e-06   0.000000      0.000000  4.733208e-06       0.000000          1.0  1.172269e-06    0.000000            1.0        0.000021      Bot     0.559575
    2.337090e-03   0.002158      1.000000  6.606897e-04       0.538568          0.0  9.405008e-05    0.000289            1.0        0.021751      Benign     0.534169
   
### Clean training and Serving Pods

To delete training and serving pods
 
     $ kustomize build blerssi_kustomize/base/network_train | kubectl delete -f -
     tfjob.kubeflow.org "train-network-tfjob"

     $ kustomize build blerssi_kustomize/base/network_serve | kubectl delete -f -
	 service "serve-network-service" deleted
     deployment.apps "serve-network-v1" deleted

